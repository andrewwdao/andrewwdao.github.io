function fft(r,f,o,t){var n,a,e,i,h,M,u,I,c,s,l,v,p,P,W,d=Math.PI;if((u=isPwrOf2(f))<0)alert("Npair must be power of 2 from 4 to 4096");else{if(n=f-1,a=f/2,r<0)for(e=0;e<f;e++)t[e]*=-1;for(i=0,e=0;e<n;e++){for(e<i&&(s=o[i],l=t[i],o[i]=o[e],t[i]=t[e],o[e]=s,t[e]=l),h=a;h<i+1;)i-=h,h/=2;i+=h}for(I=1,M=1;M<=u;M++)for(c=I,I+=I,v=1,p=0,Wr=Math.cos(d/c),Wi=-Math.sin(d/c),i=1;i<=c;i++){for(e=i-1;e<=n;e+=I)Ip=e+c,s=o[Ip]*v-t[Ip]*p,l=o[Ip]*p+t[Ip]*v,o[Ip]=o[e]-s,t[Ip]=t[e]-l,o[e]=o[e]+s,t[e]=t[e]+l;P=v*Wr-p*Wi,W=v*Wi+p*Wr,v=P,p=W}if(r<0)for(e=0;e<f;e++)t[e]*=-1;else for(e=0;e<f;e++)o[e]/=f,t[e]/=f}}function isPwrOf2(r){var f=-1;for(f=2;f<13;f++)if(Math.pow(2,f)==r)return f;return-1}function calcFilter(r,f,o,t,n){var a,e,i,h=(t-1)/2,M=[],u=Math.PI,I=[];for(M[0]=2*(o-f)/r,e=1;e<=h;e++)M[e]=(Math.sin(2*e*u*o/r)-Math.sin(2*e*u*f/r))/(e*u);for(i=Ino(a=n<21?0:n>50?.1102*(n-8.7):.5842*Math.pow(n-21,.4)+.07886*(n-21)),e=0;e<=h;e++)I[h+e]=M[e]*Ino(a*Math.sqrt(1-e*e/(h*h)))/i;for(e=0;e<h;e++)I[e]=I[t-1-e];return I}function Ino(r){var f=0,o=1,t=1;do{t+=o*=r*r/((f+=2)*f)}while(o>1e-6*t);return t}function kbWnd(r,f){var o,t,n,a,e=[];for(t=Ino(Math.PI*f),a=r/2,e[0]=0,e[a]=2,n=1;n<a;n++)o=Ino(Math.PI*f*Math.sqrt(1-n*n/(a*a))),e[a+n]=2*o/t,e[a-n]=e[a+n];return e}function hannWnd(r){var f,o,t=new Array(r);for(o=r/2,t[0]=0,t[o]=2,f=1;f<o;f++)t[o+f]=1+Math.cos(Math.PI*f/o),t[o-f]=t[o+f];return t}function corrFilter(r,f,o,t,n){var a,e,i=r.length,h=0;for((n==undefined||n<2)&&(n=1),e=0;e<t;e++){for(a=0;a<i;a++)h+=r[a]*f[n*e+a];o[e]=h,h=0}}function convFilter(r,f,o,t,n){var a,e,i=r.length,h=0;for((n==undefined||n<2)&&(n=1),e=i;e<t+i;e++){for(a=0;a<i;a++)h+=r[a]*f[n*e-a];o[e-i]=h,h=0}}function overlapSaveFilter(r,f,o,t,n,a){var e,i,h,M,u,I=r.length,c=(I-1)/2,s=1024,l=s-I+1,v=Math.ceil(a/l),p=[],P=[],W=[],d=[],w=0,F=0;for(h=0;h<1024;h++)W[h]=0,d[h]=0;for(e=Math.abs(r[c]),W[0]=r[c]/e,h=1;h<=c;h++)W[h]=r[c+h]/e,W[s-h]=W[h];for(fft(1,s,W,d),i=0;i<c;i++)t[i]=0,n[i]=0;for(F=c,h=0;h<v;h++){for(i=0;i<s;i++)p[i]=f[w+i],P[i]=o[w+i];for(w+=l,fft(1,s,p,P),i=0;i<s;i++)M=p[i]*W[i]-P[i]*d[i],u=p[i]*d[i]+P[i]*W[i],p[i]=M,P[i]=u;for(fft(-1,s,p,P),i=0;i<l&&!(F+i>=a);i++)t[F+i]=p[c+i],n[F+i]=P[c+i];F+=l}}function freqTranslate(r,f,o,t,n,a){var e,i=1/n;for(e=0;e<t;e++)f[e]=r[e]*Math.cos(2*Math.PI*a*e*i),o[e]=-r[e]*Math.sin(2*Math.PI*a*e*i)}